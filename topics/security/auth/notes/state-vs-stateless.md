# 🔄 상태 기반 vs 무상태 인증

**상태 기반 인증(Stateful)** 과 **무상태 인증(Stateless)** 은 서버가 **세션 상태를 유지하느냐 여부**에 따라 나뉘는 인증 방식

- 상태 기반: 서버가 로그인 정보를 기억함  
- 무상태: 서버는 기억 안 함, 대신 매 요청마다 증거(JWT 등)를 제출해야 함

---

## 1️⃣ 개념 비교

| 항목             | 상태 기반 인증 (Stateful)             | 무상태 인증 (Stateless)               |
|------------------|----------------------------------------|----------------------------------------|
| 상태 유지        | ✅ 서버가 사용자 상태(세션)를 저장       | ❌ 서버는 상태를 저장하지 않음         |
| 인증 방식        | 세션 ID 기반                           | 토큰(JWT) 기반                         |
| 저장 위치        | 세션 정보는 서버 메모리나 DB에 저장     | 토큰은 클라이언트가 보관               |
| 요청 처리 방식    | 세션 ID로 사용자 정보 조회              | 토큰 자체에 사용자 정보 포함            |
| 서버 확장성      | 확장 시 세션 동기화 필요                | 확장에 유리 (서버 간 상태 공유 불필요)   |
| 보안 위험 요소    | 세션 탈취 (Session Hijacking)          | 토큰 탈취 (Token Leakage)             |
| 로그아웃 처리    | 서버에서 세션 제거                      | 토큰 만료 전까지는 완전한 로그아웃 어려움 |

---

## 2️⃣ 인증 흐름 차이

### 1) 상태 기반 인증 (`Session` 기반)
1. 로그인 시 서버가 세션 ID 생성
2. 서버에 사용자 상태 저장
3. 클라이언트는 세션 ID를 쿠키로 저장
4. 요청마다 세션 ID를 전송 → 서버가 상태 조회

---

### 2) 무상태 인증 (`JWT` 기반)
1. 로그인 시 서버가 JWT(서명된 토큰)를 생성
2. 클라이언트가 JWT를 저장 (로컬스토리지 등)
3. 요청마다 JWT를 헤더에 포함하여 전송
4. 서버는 토큰만 검사하고 상태 저장 X

---

## 3️⃣ 예시 상황 비교

| 상황         | 상태 기반 인증                     | 무상태 인증                        |
|--------------|------------------------------------|------------------------------------|
| 로그인        | 세션 ID 발급 후 서버에 저장         | JWT 발급 후 클라이언트가 저장       |
| 요청 처리     | 세션 ID → 서버에서 사용자 조회      | JWT 토큰만으로 사용자 정보 판단 가능     |
| 서버 재시작    | 세션이 지워지면서 로그인이 풀림           | 토큰이 살아있으면 계속 인증 가능     |

---

## 4️⃣ 선택 기준 요약

| 조건                      | 추천 방식           |
|---------------------------|---------------------|
| 보안에 민감한 시스템       | 상태 기반 인증       |
| 서버 확장성과 유연성 필요 | 무상태 인증 (JWT)    |
| 로그아웃/세션 무효화 중요 | 상태 기반 인증       |
| 모바일/SPA 환경           | 무상태 인증 (JWT)    |

---

## 🎯 정리

✔ `Stateful` → 서버가 기억함 (`Session` 기반)  
✔ `Stateless` → 서버는 기억 안 함 (`Token` 기반)  
✔ 선택은 상황/요구사항에 따라 달라짐  
✔ 보안, 확장성, 유연성 모두 고려해야 함  

