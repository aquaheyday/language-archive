# 🍪 쿠키(Cookie) 개념 & 보안 설정

쿠키(Cookie) 는 웹 브라우저에 저장되는 key-value 형태의 데이터로, 클라이언트 또는 서버에서 생성 가능하며, 다음 요청 시 자동으로 서버에 전송되는 특징이 있음

---

## 1️⃣ 쿠키의 기본 개념

| 항목        | 설명 |
|-------------|------|
| 저장 위치     | 클라이언트(브라우저)에 저장됨 |
| 자동 전송     | 같은 도메인 요청 시 쿠키 자동 포함 |
| 저장 내용     | 세션 ID, 로그인 상태, 장바구니 정보 등 |
| 구성 형태     | `key=value` 쌍 (예: `sessionId=abc123`) |

---

## 2️⃣ 쿠키 동작 흐름

1. 클라이언트가 서버에 요청
2. 서버가 **Set-Cookie** 헤더로 쿠키 전송
3. 브라우저가 쿠키를 저장
4. 이후 동일한 도메인 요청 시 쿠키 자동 포함

#### 1. 응답 헤더 예시:
```
Set-Cookie: sessionId=abc123; Path=/; HttpOnly; Secure
```
#### 2. 요청 헤더 예시:
```
Cookie: sessionId=abc123
```
---

## 3️⃣ 쿠키 주요 속성

| 속성         | 설명 |
|--------------|------|
| `name=value` | 쿠키의 이름과 값 |
| `Path`       | 쿠키가 전송될 URL 경로 |
| `Domain`     | 쿠키를 전송할 도메인 범위 |
| `Expires` / `Max-Age` | 쿠키 유효 기간 (지나면 삭제됨) |
| `Secure`     | HTTPS 요청에서만 전송 |
| `HttpOnly`   | JS에서 접근 불가 (XSS 방어용) |
| `SameSite`   | 교차 사이트 요청 시 쿠키 전송 정책 설정 (CSRF 방어용) |

---

## 4️⃣ 보안 관련 속성 정리

| 속성        | 보안 효과 |
|-------------|-----------|
| ✅ `Secure`   | HTTPS에서만 쿠키 전송 → 도청 방지 |
| ✅ `HttpOnly` | JS 접근 불가 → XSS로 쿠키 탈취 방지 |
| ✅ `SameSite` | 외부 사이트에서 자동 쿠키 전송 차단 → CSRF 방지 |
| ✅ `Expires` / `Max-Age` | 일정 시간 후 자동 만료로 세션 지속 시간 제한 |

---

## 5️⃣ `SameSite` 속성 종류

| 값         | 설명 |
|------------|------|
| `Strict`   | 완전한 동일 사이트 요청에서만 쿠키 전송 |
| `Lax`      | GET/링크 이동 등 일부만 허용 |
| `None`     | 모든 요청 허용 (※ `Secure` 필수) |

---

## 6️⃣ 쿠키 vs 세션 vs 토큰

| 구분       | 쿠키                         | 세션                         | 토큰 (JWT 등)               |
|------------|------------------------------|------------------------------|-----------------------------|
| 저장 위치   | 클라이언트 (브라우저)         | 서버                         | 클라이언트                  |
| 보안 책임   | 클라이언트가 보안 설정 필요     | 서버에서 관리                 | 클라이언트 저장 + 토큰 암호화 |
| 사용 방식   | 요청 시 자동 포함             | 세션 ID 통해 서버 상태 확인     | 토큰 자체가 인증 정보 포함   |

---

## 🎯 정리

✔ 쿠키는 **클라이언트에 저장되는 key=value 정보**  
✔ 보안 설정 필수: **Secure**, **HttpOnly**, **SameSite**  
✔ XSS → HttpOnly / CSRF → SameSite 로 방어  가능  
✔ 주로 세션 ID, 사용자 설정, 로그인 유지 등에 사용
