# 🧱 시스템 설계 - 데이터베이스 설계 (Database Design)

**데이터베이스 설계(Database Design)** 는 **효율적이고 일관된 방식으로 데이터를 저장하고 관리하기 위한 구조를 만드는 과정**입니다.  
서비스 성능, 확장성, 유지보수에 직접적인 영향을 줍니다.

---

## 1️⃣ DB 설계란?

| 항목     | 설명 |
|----------|------|
| **정의** | 데이터와 그 관계를 모델링하고, 저장 구조를 논리적으로 설계하는 것 |
| **목표** | 데이터의 **중복 최소화**, **일관성 유지**, **확장성 확보**, **성능 최적화** |
| **중요성** | 잘못된 설계는 나중에 **수정이 어렵고 비용이 큼** |

---

## 2️⃣ DB 설계 절차

1. 요구사항 분석 (어떤 데이터를 저장할 것인가?)
2. 엔티티 도출 (사용자, 게시글, 주문 등)
3. 속성 정의 (이름, 나이, 등록일 등)
4. 관계 설정 (1:1, 1:N, N:M)
5. 정규화 및 무결성 제약 적용
6. 인덱스 및 성능 고려
7. 스키마 문서화 및 구현

---

## 3️⃣ 데이터 모델링 기본 요소

| 구성 요소 | 설명 |
|-----------|------|
| **엔티티(Entity)** | 저장할 객체 (예: 사용자, 상품, 게시글 등) |
| **속성(Attribute)** | 엔티티가 가지는 데이터 (예: 이름, 이메일 등) |
| **관계(Relationship)** | 엔티티 간의 연관성 (예: 유저 - 게시글 = 1:N) |
| **기본 키(Primary Key)** | 각 레코드를 고유하게 식별 |
| **외래 키(Foreign Key)** | 다른 테이블과 관계 맺는 열 |

---

## 4️⃣ 정규화 (Normalization)

| 단계       | 목적 | 설명 |
|------------|------|------|
| **1NF**    | 원자성 | 컬럼은 원자 값만 가짐 (중첩 불가) |
| **2NF**    | 부분 종속 제거 | 기본키의 일부분에만 종속된 속성 제거 |
| **3NF**    | 이행 종속 제거 | 기본키가 아닌 속성 간 종속 제거 |
| 👉 과도한 정규화는 조인 증가로 성능 저하 가능 ⇒ 일부 **비정규화(Denormalization)** 필요

---

## 5️⃣ 예시: 간단한 블로그 DB 모델

```
[User]
- user_id (PK)
- username
- email

[Post]
- post_id (PK)
- user_id (FK)
- title
- content
- created_at

[Comment]
- comment_id (PK)
- post_id (FK)
- user_id (FK)
- content
- created_at
```

관계:
- User 1:N Post
- Post 1:N Comment
- User 1:N Comment

---

## 6️⃣ 데이터베이스 설계 시 고려할 점

| 항목 | 설명 |
|------|------|
| **데이터 양** | 예상 저장량, 증가 속도 |
| **읽기/쓰기 비율** | 읽기 중심인지, 쓰기 중심인지 |
| **쿼리 패턴** | 자주 사용될 조회 조건/정렬 방식 |
| **인덱스 전략** | 성능 향상을 위한 적절한 인덱싱 |
| **확장성** | 파티셔닝, 샤딩, 복제 전략 고려 |
| **무결성/일관성** | 외래키, 제약조건, 트랜잭션 설정 |

---

## 7️⃣ 관계형 vs 비관계형 비교

| 항목 | 관계형 DB (RDBMS) | 비관계형 DB (NoSQL) |
|------|------------------|---------------------|
| **스키마** | 고정 (정형화됨) | 유연함 (스키마 없음 또는 느슨함) |
| **확장성** | 수직 확장 주로 사용 | 수평 확장에 유리 |
| **예시** | MySQL, PostgreSQL, Oracle | MongoDB, Redis, Cassandra |
| **적합** | 정형화된 데이터, 복잡한 관계 | 대용량, 유연한 구조, 빠른 읽기 |

---

## 🎯 정리 요약

✔ **DB 설계는 데이터의 구조와 흐름을 결정하는 핵심 작업**  
✔ 엔티티, 속성, 관계를 바탕으로 **정규화 → 제약조건 → 인덱싱 → 성능 설계**  
✔ 잘못된 DB 설계는 성능 저하와 유지보수 악몽으로 이어짐  
✔ 정형 데이터에는 **RDB**, 유연한 대규모 데이터에는 **NoSQL** 고려  
✔ 요구사항과 사용 패턴을 기반으로 설계 방향 결정

