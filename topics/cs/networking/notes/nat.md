# 🌐 NAT & 포트포워딩

**NAT(Network Address Translation)은 사설 IP와 공인 IP 간의 주소 변환 기술입니다.**  
**포트포워딩은 NAT의 일종으로, 외부에서 내부 네트워크로의 접근을 가능하게 합니다.**

---

## 1️⃣ NAT란?

| 항목   | 설명 |
|--------|------|
| 목적   | **사설 IP ↔ 공인 IP 변환**을 통해 인터넷 통신 가능 |
| 사용 이유 | IPv4 주소 부족 문제 해결, 내부망 보호 |
| 위치   | 보통 **라우터 또는 방화벽**에 설정 |
| 대상 계층 | OSI 3계층 (네트워크 계층) |
| 주요 기능 | 주소 변환, 트래픽 제어, 보안 강화 |

---

## 2️⃣ NAT의 동작 방식

1. 내부 호스트가 외부로 패킷 전송 (사설 IP 사용)
2. NAT 장비가 **공인 IP로 변경**하여 인터넷으로 송신
3. 응답 패킷이 공인 IP로 도착하면, NAT 장비가 **원래 사설 IP로 변환 후 전달**

---

## 3️⃣ NAT의 종류

| 종류           | 설명 |
|----------------|------|
| SNAT (Source NAT) | **출발지 IP를 공인 IP로 변경**. 일반적으로 내부 → 외부 트래픽에 사용 |
| DNAT (Destination NAT) | **목적지 IP를 사설 IP로 변경**. 주로 외부 → 내부 접근 (포트포워딩) |
| PAT (Port Address Translation) | 여러 사설 IP가 **하나의 공인 IP + 포트번호**로 변환. 다중 접속 가능 |

---

## 4️⃣ 포트포워딩이란?

> 외부에서 내부 네트워크의 특정 서버나 서비스에 접근할 수 있도록 **포트를 기준으로 트래픽 전달** 설정

- **DNAT의 한 형태**
- 외부 요청 (공인 IP + 포트)을 → **내부 IP + 포트로 매핑**
- 예: `203.0.113.1:8080 → 192.168.0.10:80`

---

## 5️⃣ NAT vs 포트포워딩

| 항목             | NAT                            | 포트포워딩 |
|------------------|--------------------------------|-------------|
| 개념             | IP 주소 자체를 변환             | 포트 기준으로 트래픽 전달 |
| 방향             | 내부 → 외부 주로 사용           | 외부 → 내부 주로 사용 |
| 보안 효과        | 사설 IP 숨김                   | 특정 포트만 개방 가능 |
| 사용 예          | 일반 인터넷 접속               | 웹 서버, 게임 서버 운영 등 |

---

## 6️⃣ 설정 예시

### 리눅스 iptables DNAT (포트포워딩)

```
iptables -t nat -A PREROUTING -p tcp --dport 8080 -j DNAT --to-destination 192.168.0.10:80
```

### 라우터 포트포워딩 (개념도)

```
[외부 요청] → [공인 IP:8080] → [라우터] → [내부 IP:80]
```

---

## 🎯 정리 요약

✔ NAT는 **공인 IP ↔ 사설 IP 주소 변환** 기술  
✔ 포트포워딩은 **외부 요청을 내부 IP/포트로 전달**하는 방식  
✔ SNAT은 내부 → 외부, DNAT은 외부 → 내부 트래픽 처리  
✔ 포트포워딩은 서버 운영, 원격 접속 등에 활용  
✔ 보안상 필요한 포트만 열어주는 것이 중요
