# 📄 데이터베이스 성능 테스트 정리

---

## 1️⃣ 데이터베이스 성능 테스트란?

데이터베이스 시스템이 **얼마나 빠르고 안정적으로 데이터를 처리할 수 있는지 측정하고 검증**하는 과정입니다.

- 트랜잭션 처리 속도
- 동시 접속자 처리 능력
- 대량 데이터 처리 시 응답 시간
- 시스템 병목 구간 파악

---

## 2️⃣ 성능 테스트의 목적

| 목적 | 설명 |
|------|------|
| 응답 속도 측정 | SELECT, INSERT, UPDATE, DELETE 쿼리 속도 확인 |
| 동시 사용자 처리 능력 | 다수의 접속 요청을 처리할 수 있는지 검증 |
| 시스템 자원 사용 분석 | CPU, 메모리, I/O 부하 분석 |
| 병목 구간 식별 | 느린 쿼리, 인덱스 미사용 구간 파악 |
| 성능 튜닝 기준 확보 | DB 구조, 쿼리 개선을 위한 기초 자료 수집 |

---

## 3️⃣ 주요 성능 지표(Metrics)

| 지표 | 설명 |
|------|------|
| **응답 시간(Response Time)** | 쿼리 1건 처리 소요 시간 |
| **처리량(Throughput)** | 초당 처리 가능한 트랜잭션 수 (TPS/QPS) |
| **동시 접속자 수** | 한 번에 처리 가능한 사용자 수 |
| **자원 사용량** | CPU, Memory, Disk I/O, 네트워크 |
| **Index 사용 여부** | 쿼리 실행 시 인덱스가 잘 활용되는지 |

---

## 4️⃣ 테스트 도구 예시

| 도구 | 설명 |
|------|------|
| **sysbench** | MySQL, PostgreSQL용 벤치마크 툴 |
| **JMeter** | 다양한 DB, 웹, API 성능 테스트 가능 |
| **pgbench** | PostgreSQL 전용 벤치마크 도구 |
| **OLTPBench** | 다양한 워크로드 제공하는 범용 성능 테스트 도구 |
| **HammerDB** | GUI 기반 성능 테스트 툴 (Oracle, SQL Server 등 지원) |
| **Custom Script** | Python, Bash, SQL 등으로 자체 시나리오 구성 가능 |

---

## 5️⃣ 성능 테스트 절차

#### 1. 목표 설정
   - "1000명의 사용자 동시 접속 시 쿼리 응답 시간은 1초 이내"

##### 2. 테스트 시나리오 설계
   - SELECT/INSERT/UPDATE/DELETE 비율 정의  
   - 워크로드(Load) 정의

#### 3. 테스트 환경 구축
   - 운영 환경과 유사한 DB/서버 환경 구성

#### 4. 부하 테스트 수행
   - 동시 사용자 수 증가시키며 테스트

#### 5. 지표 수집 및 분석
   - 응답 시간, 처리량, 에러율, 자원 사용량 확인

#### 6. 병목 원인 분석 및 튜닝
   - 느린 쿼리, 인덱스 미사용, I/O 병목 등

#### 7. 리포트 작성 및 개선안 도출

---

## 6️⃣ 성능 개선을 위한 체크리스트

- [ ] 인덱스 최적화 (WHERE, JOIN, ORDER BY에 적절히 사용)
- [ ] 불필요한 서브쿼리 제거
- [ ] 쿼리 캐시 활용
- [ ] 정규화/반정규화 균형
- [ ] 파티셔닝 도입 여부
- [ ] Connection Pool 사용
- [ ] 트랜잭션 범위 최소화
- [ ] 최신 통계 정보 갱신 (ANALYZE 등)

---

## 7️⃣ 예시 쿼리 (MySQL 기준)

```sql
-- 느린 쿼리 로그 활성화
SET GLOBAL slow_query_log = 'ON';
SET GLOBAL long_query_time = 1;

-- 실행 계획 확인 (쿼리 튜닝 전 필수)
EXPLAIN SELECT * FROM users WHERE email = 'test@example.com';
```

---

## 🎯 정리

✔ DB 성능 테스트는 **안정성과 속도를 확보하기 위한 핵심 절차**  
✔ 다양한 지표와 도구를 통해 병목을 찾아내고 최적화 가능  
✔ 테스트 → 분석 → 튜닝 → 반복을 통해 시스템 성능 향상  

