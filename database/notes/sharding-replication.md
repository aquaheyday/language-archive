# 📄 샤딩(Sharding) & 레플리케이션(Replication)

---

## 1️⃣ 샤딩(Sharding)이란?

**샤딩(Sharding)** 은 **데이터를 수평으로 분할**하여 여러 서버(노드)에 분산 저장하는 기술입니다.

#### 1. 핵심 개념
- 하나의 테이블(또는 컬렉션)을 **여러 서버에 나눠 저장**
- 각 서버는 전체 데이터의 **일부만** 저장 → **수평 확장(Scale-out)** 가능
- 사용자 ID, 지역, 해시 값 등 특정 기준으로 데이터 분할

#### 2. 장점
- **확장성**: 데이터가 많아져도 노드를 추가하면 확장 가능  
- **성능 향상**: 읽기/쓰기 부하 분산  
- **대용량 처리**에 적합

#### 3. 단점
- **복잡한 쿼리 처리** (여러 샤드에서 조합 필요)  
- **샤드 키(Sharding Key)** 설계 중요  
- 관리 복잡도 증가

---

## 2️⃣ 레플리케이션(Replication)이란?

**레플리케이션(Replication)** 은 **같은 데이터를 여러 서버에 복제**하여 **고가용성(Availability)** 을 확보하는 기술입니다.

#### 1. 핵심 개념
- 하나의 데이터를 **여러 노드에 복사**
- 일반적으로 하나의 **Primary(또는 Master)** 와 여러 **Secondary(Replica)** 구성
- Primary에 쓰기, Replica에서 읽기 가능 → **읽기 부하 분산**

#### 2. 장점
- **장애 대비 (Failover)**: Primary 장애 시 자동 전환  
- **백업 및 안정성 향상**  
- **읽기 성능 향상** (Replica에서 읽기 가능)

#### 3. 단점
- **쓰기에는 효과 없음** (복제 지연 발생 가능)  
- 데이터 일관성 문제 발생 가능 (지연 복제)

---

## 3️⃣ 샤딩 vs 레플리케이션

| 항목 | 샤딩 (Sharding) | 레플리케이션 (Replication) |
|------|------------------|-----------------------------|
| 목적 | **확장성(Scale)** | **가용성(Availability)** |
| 방식 | 데이터 분산 저장 | 데이터 복제 저장 |
| 데이터 저장 | 각 노드가 일부 데이터 보유 | 모든 노드가 전체 데이터 보유 |
| 쓰기 처리 | 각 샤드로 분산 가능 (쓰기 확장) | Primary에 집중 (쓰기 한정) |
| 읽기 처리 | 샤드마다 일부 읽기 | Replica 통해 분산 가능 |
| 장애 대응 | 일부 샤드 장애 시 데이터 손실 가능 | 자동 장애 전환(Failover) 가능 |
| 구성 예 | MongoDB Shard Cluster | MongoDB Replica Set |

---

## 4️⃣ MongoDB 예시

#### 1. 샤딩 구성
- `mongos` : 쿼리 라우터
- `config server` : 메타데이터 저장
- `shard` : 실제 데이터를 분산 저장

#### 2. 레플리카셋 구성
- `Primary` : 쓰기 담당
- `Secondary` : 읽기/복제
- `Arbiter` : 투표만 함, 데이터 저장 안 함 (선택사항)

---

## 🎯 정리

✔ **샤딩**: 데이터를 나눠서 저장 → **확장성 확보**  
✔ **레플리케이션**: 데이터를 복제해서 저장 → **장애 대응 + 가용성 확보**  
✔ 대규모 시스템에서는 **샤딩 + 레플리케이션 병행 구성**도 많이 사용  
✔ 둘 다 분산 시스템의 핵심 구성 요소
